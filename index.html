<!DOCTYPE html>
<html>

<head>


  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

  <script src="food.js"></script>

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans&family=Roboto:wght@300&display=swap" rel="stylesheet">
  

  
  <script>

    $(document).ready(function () {
      fillCartOnSessionStart();
    });

    function Food(name, price, restaurant, description, rating, choices) {
      this.name = name;
      this.price = price;
      this.restaurant = restaurant;
      this.description = description;
      this.rating = rating;
      this.choices = choices;
      this.amount = 1;
    }


    function fillCartOnSessionStart() {
      $("#menu").html('<h1 style="text-align:center">Please select a category to get started.</h1>');
      if (sessionStorage.getItem('Cart') != null) {
        Cart = JSON.parse(sessionStorage.getItem('Cart'));
        Cart.updateTotal = function () {
          value = 0;
          for (var i = 0; i < this.foodInCart.length; i++) {
            value += (parseFloat(Cart.foodInCart[i].price) * Cart.foodInCart[i].amount);
          }
          this.total = value.toFixed(2);
        };
        updateCart();
      }
      else {
        Cart = {
          foodInCart: new Array(),
          total: '0',
          updateTotal() {
            value = 0;
            for (var i = 0; i < this.foodInCart.length; i++) {
              value += (parseFloat(Cart.foodInCart[i].price) * Cart.foodInCart[i].amount);
            }
            this.total = value.toFixed(2);
          }
        };


        $('#cart').html('<h3 style="text-align:center; border-top: 1px solid #A9A9A9; padding: 10px;">Your cart is currently empty</h3>');
      }
    }


    var Cart;


    /*
    var Cart = {
      foodInCart: new Array(),
      total: '0',

      updateTotal(){
        value = 0;
        for(var i = 0; i < this.foodInCart.length; i++){
          value += (parseFloat(Cart.foodInCart[i].price) * Cart.foodInCart[i].amount);
        }
        this.total = value.toFixed(2);
      }

    };
    */


    function food(category) {



      var foodArray;

      switch (category) {
        case 'chicken':
          foodArray = JSONmenu.Chicken;
          break;
        case 'rice':
          foodArray = JSONmenu.Rice;
          break;
        case 'noodles':
          foodArray = JSONmenu.Noodles;
          break;
        case 'soup':
          foodArray = JSONmenu.Soup;
          break;
        case 'beef':
          foodArray = JSONmenu.Beef;
          break;
      }



      var texty = '<h1 style="font-size: 46px;  border-bottom: 1px solid #A9A9A9; margin: 37px 0px"><b>' + category.charAt(0).toUpperCase() + category.slice(1) + ' Dishes</b></h1>';
      for (var i = 0; i < foodArray.length; i++) {





        texty += '<h1><b>' + foodArray[i].name + '</b><p"font-size:20px;"> $' + foodArray[i].price + '</p></h1> <p>' + foodArray[i].restaurant + 
          '</p><p>' + foodArray[i].description + '</p>'; 
          
          if(foodArray[i].choices != undefined){
            texty += '<button onclick="optionModal(\'' + category + '\',\'' + i + '\')" class="btn btn-light btn-default">Customize</button><hr>';
          }
          else texty += '<button onclick="optionModal(\'' + category + '\',\'' + i + '\')" class="btn btn-light btn-default">Add</button><hr>';
          



      }

      $('#menu').fadeOut(150, function () {
        $(this).html(texty).fadeIn(150);
      });


    }

    function optionModal(category, index) {
      var texty = "";
      var foodArray;
      var theIndex = parseInt(index);

      switch (category) {
        case 'chicken':
          foodArray = JSONmenu.Chicken;
          break;
        case 'rice':
          foodArray = JSONmenu.Rice;
          break;
        case 'noodles':
          foodArray = JSONmenu.Noodles;
          break;
        case 'soup':
          foodArray = JSONmenu.Soup;
          break;
        case 'beef':
          foodArray = JSONmenu.Beef;
          break;
      }

      if (foodArray[theIndex].choices != undefined) {
        var length = foodArray[theIndex].choices.length;

        for (var i = 0; i < foodArray[theIndex].choices.length; i++) {

          //TO-DO
          //Maybe depending if choices are radios or checkboxes, add a check.


          texty +=
            '<input type ="radio" id="option' + i + '" name="foodOption" value="' + foodArray[theIndex].choices[i] + '">' +
            '<label for="option' + i + '">' + foodArray[theIndex].choices[i] + '</label><br>';
        }

        $("#foodOptionHeader").html('<p style="font-size:70%;">Customize your ' + foodArray[theIndex].name + '!' + '<button type="button" class="close" data-dismiss="modal">&times;</button></p>');
        $("#options").html(texty + ' <button onclick="foodToCart(\'' + category + '\',\'' + index + '\'' + ',\'' +
          length + '\')" class="btn btn-light btn-default pull-right" data-dismiss="modal">Add</button>');
        $("#optionModal").modal();
      }
      else {
        foodToCart(category, index, 0);
      }
    }


    function foodToCart(category, index, options) {

      var theIndex = parseInt(index);
      var food;
      switch (category) {
        case 'chicken':
          food = JSONmenu.Chicken[theIndex];
          break;
        case 'rice':
          food = JSONmenu.Rice[theIndex];
          break;
        case 'noodles':
          food = JSONmenu.Noodles[theIndex];
          break;
        case 'soup':
          food = JSONmenu.Soup[theIndex];
          break;
        case 'beef':
          food = JSONmenu.Beef[theIndex];
          break;
      }
      var theOptions = new Array();

      if (options > 0) { //this is a check to see how many options are selected
        for (var i = 0; i < options; i++) {
          if (document.getElementById('option' + i).checked) {
            //alert('option' + i);
            //alert(document.getElementById('option' + i).value);
            theOptions.push(document.getElementById('option' + i).value);
          }
        }
      }

      var theFood = new Food(food.name, food.price, food.restaurant, food.description, food.rating, theOptions);
      Cart.foodInCart.push(theFood);
      updateCart();
      //alert()
    }

    function updateCart() {

      Cart["updateTotal"]();


      var total = '<h2>Total: $' + Cart.total + '</h2>';
      var texty = "";
      for (var i = 0; i < Cart.foodInCart.length; i++) {
        texty += '<p style="font-size:130%; border-top: 1px solid #A9A9A9; padding: 4px">' + Cart.foodInCart[i].amount + ' ' + Cart.foodInCart[i].name + '<span style="float: right"> $' + Cart.foodInCart[i].price + ' </span></p><ul>';
        for (var j = 0; j < Cart.foodInCart[i].choices.length; j++) {
          texty += '<li>' + Cart.foodInCart[i].choices[j] + '</li>'
        }
        texty += '</ul>';
      }

      $("#cart").html(texty);
      $("#cartTotal").html(total + '<a href="payment.html" class="btn btn-light btn-default" onclick="saveCartSession()">Continue to Checkout</a>');
      saveCartSession();
    }


    function saveCartSession() {
      var cartData = JSON.stringify(Cart);
      sessionStorage.setItem('Cart', cartData);

    }

  </script>

  <style>


    

    
    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
    }

    input[type="radio"] {
      margin-right: 10px;
    }



    .navbar {
      border-radius: 0;
      overflow: hidden;
      background-color: rgb(189, 54, 54);
      position: fixed;
      top: 0;
      width: 100%;
      z-index:100;
    }

    .navbar a {
      float: left;
      display: block;
      color: #f2f2f2;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
    }

    .navbar button {
      background-color: rgb(189, 54, 54);
      border: none;
      float: right;
      display: block;
      color: #f2f2f2;
      text-align: center;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
    }

    .navbar button:hover {
      background: #ddd;
      color: black;
    }


    .navbar a:hover {
      background: #ddd;
      color: black;
    }



    .main {

      padding: 16px;
      margin-top: 30px;
      margin-left: 15%;
      margin-right: 25%;
      overflow: auto;
    }


    .modal-header,
    h4,
    .close {
      background-color: rgb(189, 54, 54);
      color: white !important;
      text-align: center;
      font-size: 30px;
    }

    .modal-footer {
      background-color: #f9f9f9;
    }


    .leftNav {
      border-right: 2px solid rgb(189, 54, 54);
      padding-left: 10px;
      padding-right: 10px;
      margin-top: 8px;
      background-color: rgb(245, 245, 245);
      position: fixed;
      left: 0;
      width: 15%;
      height: 100%;
    }

    .leftNav button {
      background-color: rgb(245, 245, 245);
      border: none;
      width: 100%;
      display: block;
      color: #000000;
      text-decoration: none;
      text-align: left;
      padding: 14px;
      font-size: 17px;
    }

    .leftNav button:hover {
      background: #ddd;
      color: black;

    }

    .leftNav a {
      display: block;
      color: #000000;
      padding: 14px 16px;
      text-decoration: none;
      font-size: 17px;
    }

    .leftNav a:hover {
      color: #f1f1f1;
    }

    .rightNav {
      border-left: 2px solid rgb(189, 54, 54);
      padding-left: 10px;
      padding-right: 10px;
      margin-top: 8px;
      background-color: rgb(245, 245, 245);
      position: fixed;
      right: 0;
      width: 25%;
      height: 100%;
      overflow: auto;
    }
    
  </style>
</head>

<body>

  <div class="navbar">
    <a href="index.html">refLink1</a>
    <a href="#refLink2">refLink2</a>
    <a href="#refLink3">refLink3</a>
    <button type="button" data-toggle="modal" data-target="#loginModal">Login</button>
  </div>








  <div class="container">


    <div class="modal fade" id="optionModal">

      <div class="modal-dialog" style="padding-top: 15%;">

        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header" id="foodOptionHeader" style="padding:10px 15px;">

          </div>

          <div class="modal-body" style="padding:20px 20px;">

            <div id="options" style="padding:25px 0px;">



            </div>
            <!--   <button type="submit" class="btn btn-light btn-default pull-right" data-dismiss="modal"></span>
              Add</button> -->

          </div>
        </div>

      </div>


    </div>







    <!-- LoginModal -->
    <div class="modal fade" id="loginModal" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header" style="padding:35px 50px;">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4>Login</h4>
          </div>
          <div class="modal-body" style="padding:40px 50px;">
            <form role="form">
              <div class="form-group">
                <label for="usrname"></span> Username</label>
                <input type="text" class="form-control" id="usrname" placeholder="Enter username">
              </div>
              <div class="form-group">
                <label for="psw"></span> Password</label>
                <input type="password" class="form-control" id="psw" placeholder="Enter password">
              </div>
              <div class="checkbox">
                <label><input type="checkbox" value="" checked>Remember me</label>
              </div>
              <button type="submit" class="btn btn-light btn-default" </span> Login</button>
            </form>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-danger btn-default pull-left" data-dismiss="modal"></span>
              Cancel</button>
            <p>Not a member? <a href="#">Sign Up</a></p>
            <p>Forgot <a href="#">Password?</a></p>
          </div>
        </div>

      </div>
    </div>
  </div>






  <div class="main">
    <div class="leftNav">
      <h1>Categories</h1>

      <button onclick="food('chicken')">Chicken</button>
      <button onclick="food('rice')">Rice</button>
      <button onclick="food('noodles')">Noodles</button>
      <button onclick="food('soup')">Soup</button>
      <button onclick="food('beef')">Beef</button>

      <h1>Filters</h1>
      <fieldset>
        <label for="checkbox-1">2 Star</label>
        <input type="checkbox" name="checkbox-1" id="checkbox-1">
        <label for="checkbox-2">3 Star</label>
        <input type="checkbox" name="checkbox-2" id="checkbox-2">
        <label for="checkbox-3">4 Star</label>
        <input type="checkbox" name="checkbox-3" id="checkbox-3">
        <label for="checkbox-4">5 Star</label>
        <input type="checkbox" name="checkbox-4" id="checkbox-4">
      </fieldset>

    </div>
    <div class="rightNav">
      <h1 style="text-align:center">Cart</h1>

      <div id="cart">
      </div>
      <div id="cartTotal">

      </div>
    </div>



    <!-- The main part of the page -->
    <div id="menu">
      <!-- Consists of the menu. Nothing should be in here -->
    </div>

  </div>




</body>

</html>
